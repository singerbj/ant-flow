<!DOCTYPE html>
<html ng-app="app">

<head>
    <title>Ant Flow</title>
</head>

<body ng-controller="Controller as c">

    <select ng-model="c.baseTarget" ng-change="c.update()" ng-options="key for key in c.targetKeys | orderBy:'toString()'"></select>

    <script type="text/javascript" src="//code.jquery.com/jquery-2.1.3.min.js"></script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/angular.js/1.4.4/angular.min.js"></script>
    <script>
        var app = angular.module('app', []);

        app.controller('Controller', ["$scope", "$http", function($scope, $http) {
            var self = this;
            self.targets = {};
            self.targetKeys = [];


            $http.get('/targets').success(function(targets){
                self.targets = targets;
                for (var key in targets) {
                    if (targets.hasOwnProperty(key)) {
                        self.targetKeys.push(key);
                    }
                }
                self.targetKeys.sort();
                self.baseTarget = self.targetKeys[0];
                self.buildTimeLine();
            }).error(function(err){
                console.log(err);
            });

            self.update = function(){
                console.log('update');
            };

            self.timeline = [];
            self.buildTimeLine = function(){
                var miniTL = [];
                var target = self.targets[self.baseTarget];
                // miniTL.push


            };

        }]);
    </script>
</body>

</html>
